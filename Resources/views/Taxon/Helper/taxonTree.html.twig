{% macro tree_dropdown() %}
    <div class="dropdown">
        <button class="btn btn-sm" type="button" data-bs-toggle="dropdown">
            <svg xmlns="http://www.w3.org/2000/svg" class="" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <path d="M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
                <path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
                <path d="M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
            </svg>
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Create</a></li>
            <li><a class="dropdown-item" href="#">Edit</a></li>
            <li><a class="dropdown-item" href="#">Delete</a></li>
            <li><a class="dropdown-item" href="#">Move up</a></li>
            <li><a class="dropdown-item" href="#">Move down</a></li>
        </ul>
    </div>
{% endmacro %}

{% macro tree_header(title) %}
    {% import _self as _ %}

    <div class="tree-header" data-js-tree="toggle">
        <div class="d-flex justify-content-between">
            <div class="tree-header-btn" data-js-tree="toggle-btn">
                <span class="tree-icon tree-icon-right">
                    <svg xmlns="http://www.w3.org/2000/svg" class="" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                       <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                       <path d="M9 6l6 6l-6 6"></path>
                    </svg>
                </span>
                <span class="tree-icon tree-icon-down">
                    <svg xmlns="http://www.w3.org/2000/svg" class="" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                       <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                       <path d="M6 9l6 6l6 -6"></path>
                    </svg>
                </span>
                {{ title }}
            </div>
            <div>{{ _.tree_dropdown() }}</div>
        </div>
    </div>
{% endmacro %}

{% macro tree_link(title, url) %}
    {% import _self as _ %}

    <div class="d-flex justify-content-between">
        <a class="d-flex" href="{{ url|default('#') }}">
            <span class="tree-icon tree-icon-dot">
                <svg xmlns="http://www.w3.org/2000/svg" class="" width="10" height="10" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                   <path d="M12 7a5 5 0 1 1 -4.995 5.217l-.005 -.217l.005 -.217a5 5 0 0 1 4.995 -4.783z" stroke-width="0" fill="currentColor"></path>
                </svg>
            </span>
            {{ title }}
        </a>
        <div>{{ _.tree_dropdown() }}</div>
    </div>
{% endmacro %}

{% macro render(taxons, nested = false) %}
    {% import '@SyliusAdmin/Taxon/Helper/taxonTree.html.twig' as _self %}

    <ul class="{% if nested %}tree-items{% else %}tree{% endif %}">
        {% for taxon in taxons|filter(taxon => taxon.id is not null) %}
            {% if taxon.children is not empty %}
                <li>
                {{ _self.tree_header(taxon.name) }}
                    {{ _self.render(taxon.children, true) }}
                </li>
            {% else %}
                <li>
                    {{ _self.tree_link(taxon.name, path('sylius_admin_taxon_update', { id: taxon.id })) }}
                </li>
            {% endif %}
        {% endfor %}
    </ul>
{% endmacro %}
